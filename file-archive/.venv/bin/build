#!/bin/bash

cd $VIRTUAL_ENV/..

MODULES=$(cat <<ML
file-archive-commons
file-archive-blob-storage-jpa
file-archive-blob-storage-s3
file-archive-metadata-storage-jpa
file-archive-metadata-storage-cassandra
file-archive-jaxrs
ML
)

COMPONENTS=$(cat <<CL
file-archive-service
file-archive-webapp
CL
)

rm -rf dist
mkdir dist

for module in $MODULES; do
(
    cd $module
    mvn clean install
)
done

for component in $COMPONENT; do
(
    cd $component
    mvn clean package
    cp target/$component.war ../dist/
)
done

# apidoc
# cp file-archive-service/target/file-archive-service-apidoc.war dist

